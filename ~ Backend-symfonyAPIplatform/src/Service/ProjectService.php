<?php

namespace App\Service;

use App\Entity\Project;
use App\Entity\Diagram;
use Doctrine\ORM\EntityManagerInterface;

class ProjectService
{
    private $em;

    public function __construct(EntityManagerInterface $em)
    {
        $this->em = $em;
    }

    public function createProjectWithDiagram(Project $project)
    {
        $diagram = new Diagram();
        $diagram->setJson('{"enableRtl":false,"locale":"fr-FR","animationComplete":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"click":{"closed":false,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"collectionChange":{"closed":false,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"commandExecute":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"connectionChange":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"contextMenuBeforeItemRender":{"closed":false,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"contextMenuClick":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"contextMenuOpen":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"created":{"closed":false,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"dataLoaded":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"doubleClick":{"closed":false,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"dragEnter":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"dragLeave":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"dragOver":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"drop":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"elementDraw":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"expandStateChange":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"fixedUserHandleClick":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"historyChange":{"closed":false,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"historyStateChange":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"keyDown":{"closed":false,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"keyUp":{"closed":false,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"load":{"closed":false,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"mouseEnter":{"closed":false,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"mouseLeave":{"closed":false,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"mouseOver":{"closed":false,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"mouseWheel":{"closed":false,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"onFixedUserHandleMouseDown":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"onFixedUserHandleMouseEnter":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"onFixedUserHandleMouseLeave":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"onFixedUserHandleMouseUp":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"onImageLoad":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"onUserHandleMouseDown":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"onUserHandleMouseEnter":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"onUserHandleMouseLeave":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"onUserHandleMouseUp":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"positionChange":{"closed":false,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"propertyChange":{"closed":false,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"rotateChange":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"scrollChange":{"closed":false,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"segmentChange":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"segmentCollectionChange":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"selectionChange":{"closed":false,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"sizeChange":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"sourcePointChange":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"targetPointChange":{"closed":false,"currentObservers":null,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"textEdit":{"closed":false,"isStopped":false,"hasError":false,"thrownError":null,"__isAsync":false},"width":"100%","height":"580px","contextMenuSettings":{"show":true},"enablePersistence":false,"scrollSettings":{"viewPortWidth":650.7291870117188,"viewPortHeight":580,"currentZoom":1,"horizontalOffset":0,"verticalOffset":68.8888931274414,"padding":{"left":0,"right":0,"top":0,"bottom":0},"scrollLimit":"Diagram","maxZoom":30,"minZoom":0.2,"canAutoScroll":false},"rulerSettings":{"showRulers":false,"horizontalRuler":{"orientation":"Horizontal","arrangeTick":null},"verticalRuler":{"orientation":"Vertical","arrangeTick":null}},"backgroundColor":"transparent","constraints":500,"layout":{"type":"None","enableAnimation":true,"arrangement":"Nonlinear","enableRouting":false},"snapSettings":{"constraints":31,"gridType":"Lines","verticalGridlines":{"lineIntervals":[1.25,18.75,0.25,19.75,0.25,19.75,0.25,19.75,0.25,19.75],"snapIntervals":[20],"lineDashArray":"","lineColor":"lightgray"},"horizontalGridlines":{"lineIntervals":[1.25,18.75,0.25,19.75,0.25,19.75,0.25,19.75,0.25,19.75],"snapIntervals":[20],"lineDashArray":"","lineColor":"lightgray"}},"dataSourceSettings":{"dataManager":null,"dataSource":null,"crudAction":{"read":""},"connectionDataSource":{"crudAction":{"read":""}}},"mode":"SVG","layers":[{"objects":["ActionOySgv"],"id":"default_layer","visible":true,"lock":false,"zIndex":0,"objectZIndex":14}],"nodes":[{"shape":{"type":"UmlActivity","shape":"Action"},"ports":[],"id":"ActionOySgv","container":null,"offsetX":303.5868034362793,"offsetY":156.72222220897675,"visible":true,"horizontalAlignment":"Left","verticalAlignment":"Top","backgroundColor":"transparent","borderColor":"none","borderWidth":0,"rotateAngle":0,"pivot":{"x":0.5,"y":0.5},"margin":{},"flip":"None","wrapper":{"actualSize":{"width":90,"height":90},"offsetX":303.5868034362793,"offsetY":156.72222220897675},"constraints":5240814,"style":{"fill":"white","gradient":{"type":"None"},"strokeWidth":1,"strokeColor":"black","strokeDashArray":"","opacity":1,"textOverflow":"Wrap"},"tooltip":{"content":"Action","showTipPointer":true,"width":"auto","height":"auto","isSticky":false,"relativeMode":"Object","openOn":"Auto"},"previewSize":{},"dragSize":{},"zIndex":11,"annotations":[{"id":"xLrel","content":"Hello world","annotationType":"String","style":{"strokeWidth":0,"strokeColor":"transparent","fill":"transparent","bold":false,"textWrapping":"WrapWithOverflow","color":"black","whiteSpace":"CollapseSpace","fontFamily":"Arial","fontSize":12,"italic":false,"opacity":1,"strokeDashArray":"","textAlign":"Center","textOverflow":"Wrap","textDecoration":"None"},"hyperlink":{"link":"","hyperlinkOpenState":"NewTab","content":"","textDecoration":"None"},"constraints":4,"visibility":true,"rotateAngle":0,"rotationReference":"Parent","margin":{"right":0,"bottom":0,"left":0,"top":0},"horizontalAlignment":"Center","verticalAlignment":"Center","offset":{"x":0.5,"y":0.5}}],"isExpanded":true,"expandIcon":{"shape":"None"},"fixedUserHandles":[],"flipMode":"All","inEdges":[],"outEdges":[],"parentId":"","processId":"","umlIndex":-1,"isPhase":false,"isLane":false}],"connectors":[],"pageSettings":{"orientation":"Landscape","height":null,"width":null,"background":{"source":"","color":"transparent"},"showPageBreaks":false,"fitOptions":{"canFit":false},"boundaryConstraints":"Infinity","multiplePage":false},"selectedItems":{"nodes":[],"connectors":[],"constraints":16382,"selectedObjects":[],"userHandles":[],"rotateAngle":0,"pivot":{"x":0.5,"y":0.5},"width":0,"height":0,"offsetX":0,"offsetY":0,"handleSize":14,"canToggleSelection":false,"wrapper":null},"basicElements":[],"tooltip":{"content":""},"commandManager":{"commands":[]},"tool":3,"bridgeDirection":"Top","diagramSettings":{"inversedAlignment":true},"customCursor":[],"version":17.1}');
        $project->setDiagram($diagram);
        $this->em->persist($project);
        $this->em->flush();
    }
}